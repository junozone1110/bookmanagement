# 管理画面操作ガイド

## ログイン方法

1. ブラウザで管理画面にアクセス
   ```
   http://localhost:8001/admin/
   ```

2. ログイン情報を入力
   - **ユーザー名**: `admin`
   - **パスワード**: `admin123`

## 📚 書籍管理

### 書籍一覧画面

書籍の一覧を確認できます。

**表示項目**:
- 📷 書影（サムネイル画像）
- 📖 書籍名
- ✍️ 著者
- 🔢 ISBNコード
- 🏷️ ステータスバッジ（色分け）
  - 🟠 **購入中** (ordered)
  - 🟢 **本棚保管中** (available)
  - 🔵 **貸出中** (rented)
  - ⚫ **その他** (other)
- 👤 現在の貸出人（貸出中の場合）
- 📍 保管場所
- 📅 作成日時

**検索機能**:
- 書籍名、著者、ISBN、申請番号、申請者名、承認者名で検索可能
- 右側のフィルターでステータス、日付で絞り込み

### 書籍詳細・編集画面

個別の書籍情報を確認・編集できます。

**セクション**:

1. **書籍情報**
   - ISBNコード
   - 書籍名
   - 著者
   - 出版社
   - 出版日
   - 書籍概要
   - 書影URL
   - 書影プレビュー（画像表示）

2. **申請情報**（折りたたみ）
   - 申請番号
   - 申請者名
   - 承認者名
   - 申請日
   - 承認日
   - 価格

3. **管理情報**
   - ステータス（選択式）
   - 保管場所（フリーテキスト）

4. **タイムスタンプ**（折りたたみ）
   - 作成日時
   - 更新日時

### 書籍の操作例

#### ステータスの変更

1. 書籍一覧から編集したい書籍をクリック
2. 「管理情報」セクションの「ステータス」を変更
   - 購入中 → 本棚保管中（書籍が届いた時）
   - 本棚保管中 → 貸出中（貸し出す時）
   - 貸出中 → 本棚保管中（返却された時）
3. 「保存」ボタンをクリック

**注意**: ステータスを「貸出中」に変更する際は、別途「貸出履歴」テーブルから貸出記録を作成する必要があります。

#### 保管場所の設定

1. 書籍詳細画面で「管理情報」セクション
2. 「保管場所」に本棚の位置を入力
   - 例: `本棚A-1`、`2F書庫-B3`
3. 「保存」ボタンをクリック

#### 新規書籍の追加

1. 書籍一覧画面右上の「書籍を追加」ボタン
2. 必要な情報を入力
   - 申請情報（必須）
   - 書籍情報（必須）
   - 管理情報（任意）
3. 「保存」ボタンをクリック

## 📖 貸出履歴管理

### 貸出履歴一覧画面

書籍の貸出・返却履歴を確認できます。

**表示項目**:
- 📚 書籍名と貸出状況
  - ✅ 返却済み（緑）
  - 📖 貸出中（青）
- 👤 貸出人バッジ
- 📅 貸出日
- 📅 返却予定日
- 📅 実際の返却日
- ⚠️ 延滞状況
  - 🔴 延滞中（日数表示）
  - 🟢 期限内
  - ⚪ 返却済み

**検索機能**:
- 書籍名、貸出人名で検索可能
- 日付でフィルタリング

### 貸出記録の追加

1. 貸出履歴一覧画面右上の「貸出履歴を追加」ボタン
2. 情報を入力
   - **書籍**: ドロップダウンから選択
   - **貸出人名**: 手入力
   - **貸出日**: 今日の日付（変更可）
   - **返却予定日**: 通常は2週間後
   - **実際の返却日**: 空欄（返却時に入力）
3. 「保存」ボタンをクリック

**同時に行うこと**:
- 書籍のステータスを「貸出中」に変更

### 返却処理

1. 該当する貸出履歴を検索
2. 貸出履歴をクリックして編集画面を開く
3. **実際の返却日**に今日の日付を入力
4. 「保存」ボタンをクリック

**同時に行うこと**:
- 書籍のステータスを「本棚保管中」に変更

### 延滞確認

一覧画面で「⚠ ○日延滞」と赤く表示されている記録が延滞中です。

## ⚠️ エラーログ管理

バッチ処理で発生したエラーを確認できます。

**表示項目**:
- ⚠️ エラー種別バッジ
- 申請番号
- ISBNコード
- エラーメッセージ
- 発生日時

**エラー種別**:
- 🔴 **INITIALIZATION_ERROR**: API初期化エラー
- 🟠 **INVALID_ISBN**: ISBN形式エラー
- 🟠 **BOOK_NOT_FOUND**: 書籍情報が見つからない
- 🔴 **PROCESSING_ERROR**: 処理エラー
- 🔴 **BATCH_ERROR**: バッチ全体のエラー

**注意**:
- エラーログは読み取り専用です
- 追加・編集・削除はできません（システムが自動作成）

## 💡 便利な機能

### 検索機能

各一覧画面の右上に検索ボックスがあります。
- 複数のフィールドを同時検索
- 部分一致で検索可能

### フィルター機能

画面右側のフィルターパネルで絞り込みができます。
- ステータス別
- 日付範囲別
- その他カスタムフィルター

### ソート機能

列見出しをクリックすると、その列でソートできます。
- 昇順・降順の切り替え可能

### ページネーション

一覧画面は20件ずつ表示されます。
- 画面下部のページ番号で移動

### アクション機能

複数レコードを選択して一括操作ができます。
- チェックボックスで選択
- アクションドロップダウンから操作を選択
- 「実行」ボタンをクリック

## 🎨 ステータスの色分け

書籍のステータスは色で視覚的に区別できます：

| ステータス | 色 | 説明 |
|-----------|---|------|
| 🟠 購入中 | オレンジ | 書籍を注文済み、到着待ち |
| 🟢 本棚保管中 | 緑 | 貸出可能な状態 |
| 🔵 貸出中 | 青 | 誰かが借りている |
| ⚫ その他 | グレー | 紛失、廃棄など |

## 🔍 よくある操作

### 貸出可能な書籍を探す

1. 書籍一覧画面を開く
2. 右側フィルターで「ステータス: 本棚保管中」を選択
3. 検索ボックスで書籍名や著者名を検索

### 特定の人が借りている書籍を探す

1. 書籍一覧画面を開く
2. 検索ボックスに貸出人の名前を入力
3. または、貸出履歴画面で検索

### 延滞している書籍を確認

1. 貸出履歴画面を開く
2. 赤色の「⚠ ○日延滞」バッジがついている記録を確認

### 書籍の貸出履歴を確認

1. 書籍詳細画面を開く
2. 画面下部の「貸出履歴」セクションを確認
3. または、貸出履歴画面で書籍名で検索

## ⚙️ 設定・管理

### パスワード変更

1. 画面右上のユーザー名をクリック
2. 「パスワードの変更」を選択
3. 現在のパスワードと新しいパスワードを入力

### ログアウト

画面右上の「ログアウト」リンクをクリック

## 🆘 トラブルシューティング

### 書影が表示されない

書影URLが正しく設定されているか確認してください。
- Google Books APIから取得した場合は自動設定されます
- 手動で登録した場合はURLを確認

### 検索で見つからない

- 全角・半角を確認
- 部分一致で検索しているか確認
- フィルターがかかっていないか確認

### ステータスが変更できない

- 編集権限があるか確認
- 必須項目が入力されているか確認

## 📞 サポート

問題が解決しない場合は、システム管理者に連絡してください。

---

**作成日**: 2025年10月16日  
**バージョン**: 1.0  
**対象**: 管理者・運用担当者

